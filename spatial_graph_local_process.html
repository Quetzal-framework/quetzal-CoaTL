<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta name="generator" content="Doxygen 1.9.8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Quetzal-CoaTL: Autoregressive processes and time series</title>
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-darkmode-toggle.js" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-fragment-copy-button.js" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
  <script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
  </script>
  <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
  <script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
  </script>
  <a href="https://github.com/Quetzal-framework/quetzal-CoaTL" class="github-corner" aria-label="View source on GitHub">
    <svg width="80" height="80" viewBox="0 0 250 250"
      style="fill:#70B7FD; color:#151513; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
      <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
      <path
        d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
        fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
      <path
        d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
        fill="currentColor" class="octo-body">
      </path>
    </svg>
  </a>
  <style>
    .github-corner:hover .octo-arm {
      animation: octocat-wave 560ms ease-in-out
    }
    @keyframes octocat-wave {
      0%,
      100% {
        transform: rotate(0)
      }
      20%,
      60% {
        transform: rotate(-25deg)
      }
      40%,
      80% {
        transform: rotate(10deg)
      }
    }
    @media (max-width:500px) {
      .github-corner:hover .octo-arm {
        animation: none
      }
      .github-corner .octo-arm {
        animation: octocat-wave 560ms ease-in-out
      }
    }
  </style>
</head>
<body>
  <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div id="titlearea">
      <table cellspacing="0" cellpadding="0">
        <tbody>
          <tr style="height: 56px;">
            <td id="projectlogo"><img alt="Logo" src="quetzal-coaltl-fa.png" /></td>
            <td id="projectalign" style="padding-left: 0.5em;">
              <div id="projectname">Quetzal-CoaTL
              </div>
              <div id="projectbrief">The Coalescence Template Library</div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <!-- end header part --><!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('spatial_graph_local_process.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Autoregressive processes and time series</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><ul><li class="level2"><a href="#autotoc_md125">Background</a></li>
<li class="level2"><a href="#autotoc_md126">Autoregressive Models</a></li>
<li class="level2"><a href="#autotoc_md128">Deterministic Models</a></li>
<li class="level2"><a href="#autotoc_md130">Stochastic Models</a></li>
<li class="level2"><a href="#autotoc_md132">Environmental Niche Models</a></li>
<li class="level2"><a href="#autotoc_md134">Species Competition Models</a></li>
</ul>
</ul>
</div>
<div class="textblock"><h2><a class="anchor" id="autotoc_md125"></a>
Background</h2>
<p>While local parameters describe a static relationship to the environment, local processes on a spatial graph are dynamic in nature. They encompass the dynamic phenomena occurring within localized regions defined by the vertices of the graph, including interactions, transformations, and behaviors unfolding at a granular level. Understanding these processes is vital for comprehending how spatial relationships evolve, how information or resources propagate through the graph, and how localized phenomena contribute to broader spatial patterns and their temporal trends.</p>
<p>In the realm of ecology and evolution, these local processes encompass the intricate dynamics unfolding within specific ecological niches or habitats delineated by the vertices of the graph. These processes encapsulate ecological interactions, evolutionary adaptations, and population dynamics occurring at localized scales, shaping the distribution, abundance, and genetic diversity of species within the spatial landscape.</p>
<p>Formalizing these local processes is crucial for understanding ecological community assembly, species responses to environmental changes, and the emergence of biodiversity patterns in spatially diverse landscapes. By investigating local ecological and evolutionary dynamics, researchers can uncover the mechanisms underlying species interactions, habitat fragmentation, and speciation events, thus deepening our understanding of ecosystem functioning and resilience in the face of environmental perturbations.</p>
<p>Local population growth models, integral to ecological and evolutionary studies, allow researchers to simulate and comprehend population dynamics within specific geographic areas or habitats. These models consider environmental conditions, species interactions, and demographic processes to forecast changes in population size and composition over time.</p>
<p>This page provides examples of how to combine <b>Quetzal</b> components to construct the local simulation process corresponding to your hypotheses.</p>
<h2><a class="anchor" id="autotoc_md126"></a>
Autoregressive Models</h2>
<p>A process in which the value at time \( t \) depends on its value at time \( t−1 \) (like population growth over time) is commonly referred to as an autoregressive process or a first-order autoregressive process ( \(AR(1)\)). These are widely used in time series analysis and modeling to capture temporal dependencies and patterns in data.</p>
<p>In mathematical terms, it can be represented as:</p>
<p class="formulaDsp">
\[
  X_t =​ \phi X_{t-1} + \epsilon_t
\]
</p>
<p>where:</p>
<ul>
<li>\( X_t \) is the value of the process at time \( t \)</li>
<li>\( X_{t-1} \) is the value of the process at time \( t-1 \)</li>
<li>\( \phi \) is the autoregressive parameter,</li>
<li>\( \epsilon_t \) is a random error term.</li>
</ul>
<p>Users can represent first-order (or even p-order) autoregressive processes using <b>Quetzal</b> components. Although flexible, the general approach will be to represent time series as <code>std::vector</code> structures embedded in each vertex or edges they relate to, where a quantity \(q\) a time \(t\) at vertex \(x\) is described by <code>graph[x][q][t]</code>.</p>
<hr  />
<h2><a class="anchor" id="autotoc_md128"></a>
Deterministic Models</h2>
<p>Deterministic models describe population growth based on precise mathematical equations that govern population dynamics. These models typically assume constant parameters and predictable relationships between population variables, such as birth rates, death rates, and carrying capacity. While deterministic models provide valuable insights into long-term population trends, they may oversimplify real-world complexities and fail to account for stochastic fluctuations or environmental variability.</p>
<p>In this example, we store a time-series vector at each vertex of the graph to monitor the population dynamics. After initializing one vertex with a non-zero value, we iterate through time to update the series. It's important to note that, since we defined no migration along the graph's edges, all time-series except one remain at zero.</p>
<p><b>Input</b></p>
<div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#include &quot;quetzal/geography.hpp&quot;</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span> </div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacequetzal_1_1geography.html">geo</a> = <a class="code hl_namespace" href="namespacequetzal_1_1geography.html">quetzal::geography</a>;</div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span> </div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="keywordtype">int</span> main()</div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span>{</div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span>    <span class="keyword">auto</span> file = std::filesystem::current_path() / <span class="stringliteral">&quot;data/bio1.tif&quot;</span>;</div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span> </div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span>    <span class="comment">// The raster have 10 bands that we will assign to 2001 ... 2010.</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span>    std::vector&lt;int&gt; times(10);</div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span>    std::iota(times.begin(), times.end(), 2001);</div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span> </div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span>    <span class="comment">// Landscape construction injecting times information</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span>    <span class="keyword">auto</span> land = <a class="code hl_class" href="classquetzal_1_1geography_1_1raster.html">geo::raster&lt;&gt;::from_file</a>(file, times);</div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span> </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span>    <span class="comment">// Graph construction with vertex and edge info</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span>    <span class="keyword">using </span><a class="code hl_struct" href="structvertex__info.html">vertex_info</a> = std::vector&lt;double&gt;;</div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span>    <a class="code hl_struct" href="structvertex__info.html">vertex_info</a> N(times.size(), 0);</div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span>    <span class="keyword">using </span><a class="code hl_struct" href="structedge__info.html">edge_info</a> = <a class="code hl_typedef" href="namespacequetzal_1_1geography.html#a9d63ec53811cfaeae6dd04b11f950a97">geo::no_property</a>;</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span>    <span class="keyword">auto</span> graph = <a class="code hl_function" href="namespacequetzal_1_1geography.html#aefd1b77745ebec6627cd0b29ac101afd">geo::from_grid</a>(land, N, <a class="code hl_struct" href="structedge__info.html">edge_info</a>(), <a class="code hl_struct" href="structquetzal_1_1geography_1_1connect__fully.html">geo::connect_fully</a>(), <a class="code hl_typedef" href="namespacequetzal_1_1geography.html#af6da7867d1c7f8864a04f8b003a4fabd">geo::isotropy</a>(), <a class="code hl_class" href="classquetzal_1_1geography_1_1mirror.html">geo::mirror</a>());</div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>    graph[0][0] = 1;</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span> </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span>    <span class="comment">// Part of what happens in a demographic simulator:</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>    <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> t = 1; t &lt; times.size(); ++t){</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>        <span class="keywordflow">for</span>( <span class="keyword">auto</span> x : graph.vertices() ){</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>            graph[x][t] = 2 * graph[x][t-1];</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>        }</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>    }</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span> </div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>    <span class="comment">// Post treatment</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>    std::cout &lt;&lt;  <span class="stringliteral">&quot;Time series:\n&quot;</span>; </div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>    <span class="keywordflow">for</span>(<span class="keyword">auto</span> x : graph.vertices()){</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>         std::cout &lt;&lt; <span class="stringliteral">&quot;at vertex &quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot; : &quot;</span>;</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span> value : graph[x] ){</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>            std::cout &lt;&lt; value &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>        }</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>    }</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>}</div>
<div class="ttc" id="aclassquetzal_1_1geography_1_1mirror_html"><div class="ttname"><a href="classquetzal_1_1geography_1_1mirror.html">quetzal::geography::mirror</a></div><div class="ttdoc">Individuals can not escape the landscape's borders.</div><div class="ttdef"><b>Definition</b> bound_policy.hpp:20</div></div>
<div class="ttc" id="aclassquetzal_1_1geography_1_1raster_html"><div class="ttname"><a href="classquetzal_1_1geography_1_1raster.html">quetzal::geography::raster</a></div><div class="ttdoc">Discrete spatio-temporal variations of an environmental variable.</div><div class="ttdef"><b>Definition</b> raster.hpp:38</div></div>
<div class="ttc" id="anamespacequetzal_1_1geography_html"><div class="ttname"><a href="namespacequetzal_1_1geography.html">quetzal::geography</a></div><div class="ttdoc">Geospatial data formatting and processing.</div><div class="ttdef"><b>Definition</b> geography.hpp:17</div></div>
<div class="ttc" id="anamespacequetzal_1_1geography_html_a9d63ec53811cfaeae6dd04b11f950a97"><div class="ttname"><a href="namespacequetzal_1_1geography.html#a9d63ec53811cfaeae6dd04b11f950a97">quetzal::geography::no_property</a></div><div class="ttdeci">boost::no_property no_property</div><div class="ttdoc">Represents no information carried by vertices or edges of a graph.</div><div class="ttdef"><b>Definition</b> concepts.hpp:71</div></div>
<div class="ttc" id="anamespacequetzal_1_1geography_html_aefd1b77745ebec6627cd0b29ac101afd"><div class="ttname"><a href="namespacequetzal_1_1geography.html#aefd1b77745ebec6627cd0b29ac101afd">quetzal::geography::from_grid</a></div><div class="ttdeci">auto from_grid(SpatialGrid const &amp;grid, VertexProperty const &amp;v, EdgeProperty const &amp;e, Vicinity const &amp;vicinity, Directionality dir, Policy const &amp;bounding_policy)</div><div class="ttdoc">Spatial graph construction method.</div><div class="ttdef"><b>Definition</b> from_grid.hpp:36</div></div>
<div class="ttc" id="anamespacequetzal_1_1geography_html_af6da7867d1c7f8864a04f8b003a4fabd"><div class="ttname"><a href="namespacequetzal_1_1geography.html#af6da7867d1c7f8864a04f8b003a4fabd">quetzal::geography::isotropy</a></div><div class="ttdeci">boost::undirectedS isotropy</div><div class="ttdoc">Property of a process independent of the direction of movement.</div><div class="ttdef"><b>Definition</b> directionality.hpp:18</div></div>
<div class="ttc" id="astructedge__info_html"><div class="ttname"><a href="structedge__info.html">edge_info</a></div><div class="ttdef"><b>Definition</b> geography_dispersal_kernel_4.cpp:13</div></div>
<div class="ttc" id="astructquetzal_1_1geography_1_1connect__fully_html"><div class="ttname"><a href="structquetzal_1_1geography_1_1connect__fully.html">quetzal::geography::connect_fully</a></div><div class="ttdef"><b>Definition</b> vicinity.hpp:53</div></div>
<div class="ttc" id="astructvertex__info_html"><div class="ttname"><a href="structvertex__info.html">vertex_info</a></div><div class="ttdef"><b>Definition</b> coalescence_binary_tree_2.cpp:5</div></div>
</div><!-- fragment --><p><b>Output</b></p>
<div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span>Time series:</div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span>at vertex 0 : 1 2 4 8 16 32 64 128 256 512 </div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span>at vertex 1 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span>at vertex 2 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span>at vertex 3 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span>at vertex 4 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span>at vertex 5 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span>at vertex 6 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span>at vertex 7 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span>at vertex 8 : 0 0 0 0 0 0 0 0 0 0 </div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md130"></a>
Stochastic Models</h2>
<p>Stochastic models introduce randomness and variability into population growth processes, acknowledging the inherent uncertainty in ecological systems. These models incorporate probabilistic elements, such as random fluctuations in birth and death rates, environmental variability, and demographic stochasticity. Stochastic models are particularly useful for capturing the effects of environmental variability and demographic stochasticity on population dynamics, allowing researchers to assess the likelihood of rare events and population extinctions.</p>
<p>We build up on the previous example by adding some stochasticity in the process. We store a time-series vector at each vertex of the graph to monitor the population dynamics. After initializing some vertices with a non-zero value, we iterate through time to update the series. It's important to note that, since we defined no migration along the graph's edges, some time-series remain at zero.</p>
<p><b>Input</b></p>
<div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#include &quot;quetzal/geography.hpp&quot;</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="preprocessor">#include &lt;random&gt;</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span> </div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacequetzal_1_1geography.html">geo</a> = <a class="code hl_namespace" href="namespacequetzal_1_1geography.html">quetzal::geography</a>;</div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span> </div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="keywordtype">int</span> main()</div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span>{</div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span>    <span class="keyword">auto</span> file = std::filesystem::current_path() / <span class="stringliteral">&quot;data/bio1.tif&quot;</span>;</div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span>    <span class="comment">// The raster have 10 bands that we will assign to 2001 ... 2010.</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span>    std::vector&lt;int&gt; times(10);</div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span>    std::iota(times.begin(), times.end(), 2001);</div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span> </div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span>    <span class="comment">// Landscape construction injecting times information</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span>    <span class="keyword">auto</span> land = <a class="code hl_class" href="classquetzal_1_1geography_1_1raster.html">geo::raster&lt;&gt;::from_file</a>(file, times);</div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span> </div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span>    <span class="comment">// Graph construction with vertex and edge info</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span>    <span class="keyword">using </span><a class="code hl_struct" href="structvertex__info.html">vertex_info</a> = std::vector&lt;double&gt;;</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span>    <a class="code hl_struct" href="structvertex__info.html">vertex_info</a> N(times.size(), 0);</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span> </div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>    <span class="keyword">using </span><a class="code hl_struct" href="structedge__info.html">edge_info</a> = <a class="code hl_typedef" href="namespacequetzal_1_1geography.html#a9d63ec53811cfaeae6dd04b11f950a97">geo::no_property</a>;</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span>    <span class="keyword">auto</span> graph = <a class="code hl_function" href="namespacequetzal_1_1geography.html#aefd1b77745ebec6627cd0b29ac101afd">geo::from_grid</a>(land, N, <a class="code hl_struct" href="structedge__info.html">edge_info</a>(), <a class="code hl_struct" href="structquetzal_1_1geography_1_1connect__fully.html">geo::connect_fully</a>(), <a class="code hl_typedef" href="namespacequetzal_1_1geography.html#af6da7867d1c7f8864a04f8b003a4fabd">geo::isotropy</a>(), <a class="code hl_class" href="classquetzal_1_1geography_1_1mirror.html">geo::mirror</a>());</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span> </div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>    <span class="comment">// Let&#39;s compare some time series</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>    graph[0][0] = 1;</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>    graph[1][0] = 1;</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>    graph[2][0] = 1;</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span> </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>    <span class="comment">// Declare a random number generator</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>    std::mt19937 rng{std::random_device{}()};</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span> </div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>    <span class="comment">// Part of what happens in a demographic simulator:</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>    <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> t = 1; t &lt; times.size(); ++t){</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>        <span class="keywordflow">for</span>( <span class="keyword">auto</span> x : graph.vertices() ){</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>            <span class="keyword">auto</span> alpha = std::uniform_real_distribution&lt;double&gt;(1, 2)(rng);</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>            graph[x][t] = alpha * graph[x][t-1];</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>        }</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>    }</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span> </div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>    <span class="comment">// Post treatment</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>    std::cout &lt;&lt;  <span class="stringliteral">&quot;Time series:\n&quot;</span>; </div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>    <span class="keywordflow">for</span>(<span class="keyword">auto</span> x : graph.vertices()){</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>         std::cout &lt;&lt; <span class="stringliteral">&quot;at vertex &quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot; : &quot;</span>;</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span> value : graph[x] ){</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>            std::cout &lt;&lt; static_cast&lt;int&gt;(value) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>        }</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>    }</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>}</div>
</div><!-- fragment --><p><b>Output</b></p>
<div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span>Time series:</div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span>at vertex 0 : 1 1 2 3 6 12 22 31 39 66 </div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span>at vertex 1 : 1 1 1 1 1 2 2 4 7 8 </div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span>at vertex 2 : 1 1 1 3 5 7 10 18 30 36 </div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span>at vertex 3 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span>at vertex 4 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span>at vertex 5 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span>at vertex 6 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span>at vertex 7 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span>at vertex 8 : 0 0 0 0 0 0 0 0 0 0 </div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md132"></a>
Environmental Niche Models</h2>
<p>Environmental niche models focus on how environmental factors influence the distribution and abundance of species within specific habitats. These models integrate ecological niche theory and environmental data to predict species' occurrence probabilities and population densities across spatial gradients. By quantifying the relationships between environmental variables (e.g., temperature, precipitation, habitat quality) and species' ecological requirements, environmental niche models help elucidate how environmental factors shape local population growth and species distributions.</p>
<p>In this example, we store a time-series vector at each vertex of the graph to monitor the population dynamics. After initializing some vertices with a non-zero value, we iterate through time to update the series conditionally to the local contemporary environmental data. It's important to note that, since we defined no migration along the graph's edges, some time-series remain at zero.</p>
<p>Since the data structures embedded in the vertices (and edges) of the graph are arbitrary, we could also store the local \(K\) and \(r\) time series alongside the population size. This can be achieved by defining a simple <code><a class="el" href="structvertex__info.html">vertex_info</a></code> class that contains three <code>std::vector</code> members. We will apply this idea in the following example for simulating a three-species competition model.</p>
<p><b>Input</b></p>
<div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#include &quot;quetzal/geography.hpp&quot;</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="preprocessor">#include &lt;random&gt;</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span> </div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacequetzal_1_1geography.html">geo</a> = <a class="code hl_namespace" href="namespacequetzal_1_1geography.html">quetzal::geography</a>;</div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span> </div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="keywordtype">int</span> main()</div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span>{</div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span>    <span class="keyword">auto</span> file = std::filesystem::current_path() / <span class="stringliteral">&quot;data/bio1.tif&quot;</span>;</div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span>    <span class="comment">// The raster have 10 bands that we will assign to 2001 ... 2010.</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span>    std::vector&lt;int&gt; times(10);</div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span>    std::iota(times.begin(), times.end(), 2001);</div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span> </div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span>    <span class="comment">// Landscape construction injecting times information</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span>    <span class="keyword">auto</span> land = <a class="code hl_class" href="classquetzal_1_1geography_1_1raster.html">geo::raster&lt;&gt;::from_file</a>(file, times);</div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span> </div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span>    <span class="comment">// Graph construction with vertex and edge info</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span>    <span class="keyword">using </span><a class="code hl_struct" href="structvertex__info.html">vertex_info</a> = std::vector&lt;double&gt;;</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span>    <a class="code hl_struct" href="structvertex__info.html">vertex_info</a> N(times.size(), 0);</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span> </div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>    <span class="keyword">using </span><a class="code hl_struct" href="structedge__info.html">edge_info</a> = <a class="code hl_typedef" href="namespacequetzal_1_1geography.html#a9d63ec53811cfaeae6dd04b11f950a97">geo::no_property</a>;</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span>    <span class="keyword">auto</span> graph = <a class="code hl_function" href="namespacequetzal_1_1geography.html#aefd1b77745ebec6627cd0b29ac101afd">geo::from_grid</a>(land, N, <a class="code hl_struct" href="structedge__info.html">edge_info</a>(), <a class="code hl_struct" href="structquetzal_1_1geography_1_1connect__fully.html">geo::connect_fully</a>(), <a class="code hl_typedef" href="namespacequetzal_1_1geography.html#af6da7867d1c7f8864a04f8b003a4fabd">geo::isotropy</a>(), <a class="code hl_class" href="classquetzal_1_1geography_1_1mirror.html">geo::mirror</a>());</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span> </div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>    <span class="comment">// Let&#39;s compare some time series</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>    graph[0][0] = 1;</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>    graph[1][0] = 1;</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>    graph[2][0] = 1;</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span> </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>    <span class="comment">// Declare a random number generator</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>    std::mt19937 rng{std::random_device{}()};</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span> </div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>    <span class="comment">// Part of what could happen in a demographic simulator:</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>    <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> t = 1; t &lt; times.size(); ++t){</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>        <span class="keywordflow">for</span>( <span class="keyword">auto</span> x : graph.vertices() ){</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>            <span class="keyword">auto</span> r = std::uniform_real_distribution&lt;double&gt;(1, 5)(rng);</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>            <span class="keyword">auto</span> K = 10. * land.at(x, t-1).value_or(10.);</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>            <span class="keyword">auto</span> P = graph[x][t-1];</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>            graph[x][t] = std::max(P + r * P * (1 - P/K), 0.);</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>        }</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>    }</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span> </div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>    <span class="comment">// Post treatment</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>    std::cout &lt;&lt;  <span class="stringliteral">&quot;Time series:\n&quot;</span>; </div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>    <span class="keywordflow">for</span>(<span class="keyword">auto</span> x : graph.vertices()){</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>         std::cout &lt;&lt; <span class="stringliteral">&quot;at vertex &quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot; : &quot;</span>;</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span> value : graph[x] ){</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>            std::cout &lt;&lt; static_cast&lt;int&gt;(value) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>        }</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>    }</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>}</div>
</div><!-- fragment --><p><b>Output</b></p>
<div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span>Time series:</div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span>at vertex 0 : 1 3 11 62 342 812 1118 1312 736 2006 </div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span>at vertex 1 : 1 4 18 81 162 317 854 1503 431 952 </div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span>at vertex 2 : 1 2 5 20 94 480 1456 0 0 0 </div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span>at vertex 3 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span>at vertex 4 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span>at vertex 5 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span>at vertex 6 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span>at vertex 7 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span>at vertex 8 : 0 0 0 0 0 0 0 0 0 0 </div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md134"></a>
Species Competition Models</h2>
<p>Species competition models explore how interspecific interactions, such as competition for resources or interactions with predators, influence population dynamics and species coexistence within local communities. These models typically incorporate competition coefficients, representing the strength of interspecific interactions, into population equations to simulate the effects of species interactions on population growth rates and carrying capacities. Species competition models provide insights into the mechanisms driving species coexistence, competitive exclusion, and community dynamics within ecological communities.</p>
<p>A discrete-time model for a three-species predator-prey competition can be complex, but here's a basic version using a system of difference equations. Let's denote the populations of the three species at time \(t\) as \(𝑃_1(t)\), \(P_2(t)\) and \(P_3(t)\). Assume that \(P_1\) is a prey species, \(P_2\) is a predator of \(P_1\) and \(P_3\) is a competing species that preys on \(P_1\) and competes with \(P_2\).</p>
<p class="formulaDsp">
\[
P_1(t+1) = P_1(t) + r_1 P_1(t) \left(1 - \frac{P_1(t)}{K_1}\right) - a_{12} P_1(t) P_2(t) - a_{13} P_1(t) P_3(t)
\]
</p>
<p class="formulaDsp">
\[
P_2(t+1) = P_2(t) + r_2 P_2(t) \left(1 - \frac{P_2(t)}{K_2}\right) + b_{21} P_1(t) P_2(t) - c_{23} P_2(t) P_3(t)
\]
</p>
<p class="formulaDsp">
\[
P_3(t+1) = P_3(t) + r_3 P_3(t) \left(1 - \frac{P_3(t)}{K_3}\right) + b_{31} P_1(t) P_3(t) - c_{32} P_2(t) P_3(t)
\]
</p>
<p>Where:</p><ul>
<li>\( r_1, r_2, r_3 \) are the intrinsic growth rates of species 1, 2, and 3, respectively.</li>
<li>\( K_1, K_2, K_3 \) are the carrying capacities for species 1, 2, and 3, respectively.</li>
<li>\( a_{12} \) is the predation rate of species 2 on species 1.</li>
<li>\( a_{13} \) is the predation rate of species 3 on species 1.</li>
<li>\( b_{21} \) is the benefit species 2 gets from preying on species 1.</li>
<li>\( c_{23} \) is the competition rate between species 2 and 3.</li>
<li>\( b_{31} \) is the benefit species 3 gets from preying on species 1.</li>
<li>\( c_{32} \) is the competition rate between species 3 and 2.</li>
</ul>
<p><b>Input</b></p>
<div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#include &quot;quetzal/geography.hpp&quot;</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="preprocessor">#include &lt;random&gt;</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span> </div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacequetzal_1_1geography.html">geo</a> = <a class="code hl_namespace" href="namespacequetzal_1_1geography.html">quetzal::geography</a>;</div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span> </div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">// Time series of the 3 species population sizes to embed along the graph</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="keyword">struct </span><a class="code hl_struct" href="structvertex__info.html">vertex_info</a> {</div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span>    <span class="keyword">using </span>time_series_type = std::vector&lt;double&gt;;</div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span>    time_series_type P1, P2, P3;</div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span>    <span class="comment">// Constructor to initialize the vectors with a specified length and fill them with zeros</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span>    <a class="code hl_struct" href="structvertex__info.html">vertex_info</a>(<span class="keywordtype">int</span> length): P1(length, 0), P2(length, 0), P3(length, 0){}</div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span>    <span class="comment">// Needs to be default constructible</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span>    <a class="code hl_struct" href="structvertex__info.html">vertex_info</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span>};</div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span> </div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment">// Overload the &lt;&lt; operator for the vertex_info struct</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span>std::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, <span class="keyword">const</span> <a class="code hl_struct" href="structvertex__info.html">vertex_info</a>&amp; vertex) {</div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span>    <span class="keyword">auto</span> format = [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp; v, <span class="keyword">const</span> <span class="keyword">auto</span>&amp; name){</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span>        os &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; : &quot;</span>;</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span>        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span>&amp; val : v)</div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>            os &lt;&lt; val &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span>        os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span>    };</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>    format(vertex.P1, <span class="stringliteral">&quot;P1&quot;</span>);</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>    format(vertex.P2, <span class="stringliteral">&quot;P2&quot;</span>);</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>    format(vertex.P3, <span class="stringliteral">&quot;P3&quot;</span>);</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>    <span class="keywordflow">return</span> os;</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>}</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span> </div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="keywordtype">int</span> main()</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>{</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>    <span class="keyword">auto</span> file = std::filesystem::current_path() / <span class="stringliteral">&quot;data/bio1.tif&quot;</span>;</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span> </div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>    <span class="comment">// The raster have 10 bands that we will assign to 2001 ... 2010.</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>    std::vector&lt;int&gt; times(10);</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>    std::iota(times.begin(), times.end(), 2001);</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span> </div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>    <span class="comment">// Landscape construction injecting times information</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>    <span class="keyword">auto</span> land = <a class="code hl_class" href="classquetzal_1_1geography_1_1raster.html">geo::raster&lt;&gt;::from_file</a>(file, times);</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span> </div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>    <span class="comment">// Graph construction with vertex and edge info</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>    <span class="keyword">using </span><a class="code hl_struct" href="structedge__info.html">edge_info</a> = <a class="code hl_typedef" href="namespacequetzal_1_1geography.html#a9d63ec53811cfaeae6dd04b11f950a97">geo::no_property</a>;</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>    <span class="keyword">auto</span> graph = <a class="code hl_function" href="namespacequetzal_1_1geography.html#aefd1b77745ebec6627cd0b29ac101afd">geo::from_grid</a>(land, <a class="code hl_struct" href="structvertex__info.html">vertex_info</a>(times.size()), <a class="code hl_struct" href="structedge__info.html">edge_info</a>(), <a class="code hl_struct" href="structquetzal_1_1geography_1_1connect__fully.html">geo::connect_fully</a>(), <a class="code hl_typedef" href="namespacequetzal_1_1geography.html#af6da7867d1c7f8864a04f8b003a4fabd">geo::isotropy</a>(), <a class="code hl_class" href="classquetzal_1_1geography_1_1mirror.html">geo::mirror</a>());</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span> </div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>    <span class="comment">// Let&#39;s initialize population sizes for a single vertex for demonstration</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>    graph[0].P1[0] = 200;</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>    graph[0].P2[0] = 1;</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>    graph[0].P3[0] = 1;</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span> </div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>    <span class="comment">// Declare a random number generator</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>    std::mt19937 rng{std::random_device{}()};</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span> </div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>    <span class="keyword">auto</span> random_double = [&amp;](<span class="keywordtype">double</span> min, <span class="keywordtype">double</span> max){ <span class="keywordflow">return</span> std::uniform_real_distribution&lt;double&gt;(min, max)(rng);};</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span> </div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>    <span class="keywordtype">double</span> r1 = random_double(0.0, 1.0);  <span class="comment">// Intrinsic growth rate for species 1</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>    <span class="keywordtype">double</span> r2 = random_double(0.0, 1.0);  <span class="comment">// Intrinsic growth rate for species 2</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>    <span class="keywordtype">double</span> r3 = random_double(0.0, 1.0);  <span class="comment">// Intrinsic growth rate for species 3</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span> </div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    <span class="keywordtype">double</span> K1 = random_double(50.0, 100.0);  <span class="comment">// Carrying capacity for species 1</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    <span class="keywordtype">double</span> K2 = random_double(50.0, 100.0);  <span class="comment">// Carrying capacity for species 2</span></div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>    <span class="keywordtype">double</span> K3 = random_double(50.0, 100.0);  <span class="comment">// Carrying capacity for species 3</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span> </div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>    <span class="keywordtype">double</span> a12 = random_double(0.0, 0.1);  <span class="comment">// Predation rate of species 2 on species 1</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>    <span class="keywordtype">double</span> a13 = random_double(0.0, 0.1);  <span class="comment">// Predation rate of species 3 on species 1</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span> </div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>    <span class="keywordtype">double</span> b21 = random_double(0.0, 0.1);  <span class="comment">// Benefit species 2 gets from preying on species 1</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    <span class="keywordtype">double</span> c23 = random_double(0.0, 0.1);  <span class="comment">// Competition rate between species 2 and 3</span></div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span> </div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    <span class="keywordtype">double</span> b31 = random_double(0.0, 0.1);  <span class="comment">// Benefit species 3 gets from preying on species 1</span></div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>    <span class="keywordtype">double</span> c32 = random_double(0.0, 0.1);  <span class="comment">// Competition rate between species 3 and 2</span></div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span> </div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>    <span class="comment">// Part of what could happen in a demographic simulator:</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>    <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> t = 1; t &lt; times.size(); ++t){</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>        <span class="keywordflow">for</span>( <span class="keyword">auto</span> x : graph.vertices() ){</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>            <span class="keyword">auto</span> P1 = graph[x].P1[t-1];</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>            <span class="keyword">auto</span> P2 = graph[x].P2[t-1];</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>            <span class="keyword">auto</span> P3 = graph[x].P3[t-1];</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>            graph[x].P1[t] = std::max(P1 + r1 * P1 * (1 - P1 / K1) - a12 * P1 * P2 - a13 * P1 * P3, 0.);</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>            graph[x].P2[t] = std::max(P2 + r2 * P2 * (1 - P2 / K2) + b21 * P1 * P2 - c23 * P2 * P3, 0.);</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>            graph[x].P3[t] = std::max(P3 + r3 * P3 * (1 - P3 / K3) + b31 * P1 * P3 - c32 * P2 * P3, 0.);</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>        }</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>    }</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span> </div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>    <span class="comment">// Post treatment</span></div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    std::cout &lt;&lt;  <span class="stringliteral">&quot;Time series:\n&quot;</span>; </div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>    <span class="keywordflow">for</span>(<span class="keyword">auto</span> x : graph.vertices()){</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>         std::cout &lt;&lt; <span class="stringliteral">&quot;at vertex &quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot; : \n&quot;</span>;</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>         std::cout &lt;&lt; graph[x] &lt;&lt; std::endl;</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>    }</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>}</div>
</div><!-- fragment --><p><b>Output</b></p>
<div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span>Time series:</div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span>at vertex 0 : </div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span>    P1 : 200 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span>    P2 : 1 8.18747 10.5327 11.2623 9.19884 4.87735 0.552305 0 0 0 </div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span>    P3 : 1 5.50375 8.80761 12.9818 18.2023 26.0187 39.5149 61.2288 82.4795 93.011 </div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span> </div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span>at vertex 1 : </div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span>    P1 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span>    P2 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span>    P3 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span> </div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span>at vertex 2 : </div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span>    P1 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span>    P2 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span>    P3 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span> </div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span>at vertex 3 : </div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span>    P1 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span>    P2 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span>    P3 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span> </div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>at vertex 4 : </div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span>    P1 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span>    P2 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>    P3 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span> </div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>at vertex 5 : </div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>    P1 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>    P2 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>    P3 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>at vertex 6 : </div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>    P1 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>    P2 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>    P3 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span> </div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>at vertex 7 : </div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>    P1 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>    P2 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>    P3 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span> </div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>at vertex 8 : </div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>    P1 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>    P2 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>    P3 : 0 0 0 0 0 0 0 0 0 0 </div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span> </div>
</div><!-- fragment --><hr  />
 </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
